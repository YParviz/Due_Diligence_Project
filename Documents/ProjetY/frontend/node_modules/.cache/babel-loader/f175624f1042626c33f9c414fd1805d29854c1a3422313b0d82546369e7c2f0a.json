{"ast":null,"code":"import React,{createContext,useContext,useState}from\"react\";import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";export const authContext=/*#__PURE__*/createContext();export const useAuth=()=>{const context=useContext(authContext);if(!context)throw new Error('There is no AuthProvider');return context;};const client=axios.create({baseURL:'http://127.0.0.1:8000/api/'});function getAuthToken(){return localStorage.getItem('token');}client.interceptors.request.use(config=>{const token=getAuthToken();if(token){config.headers['Authorization']=\"Token \".concat(token);}return config;},error=>Promise.reject(error));export function AuthProvider(_ref){let{children}=_ref;const[loading,setLoading]=useState(false);const[user,setUser]=useState({logged:false,data:[]});const login=async data=>{setLoading(true);try{const response=await client.post('login/',data);const token=response.data.token;console.log('Token:',token);localStorage.setItem('token',token);setUser({logged:true,data:response.data});}catch(err){console.error('Login error:',err);throw new Error('Login failed');}finally{setLoading(false);}};const logout=async()=>{if(!user.logged)return console.log(\"User is not logged\");setLoading(true);try{await client.post('logout/');localStorage.removeItem('token');setUser({logged:false,data:[]});}catch(err){console.error(err);throw new Error('Logout failed');}finally{setLoading(false);}};const signup=async data=>{setLoading(true);try{const res=await client.post('register/',data);return res.data;}catch(err){console.error(err);throw new Error('Signup failed');}finally{setLoading(false);}};const resetPassword=async email=>{setLoading(true);try{const res=await client.post('/reset-password',{email});return res.data;}catch(err){console.error(err);throw new Error('An error occurred while resetting the password');}finally{setLoading(false);}};const deleteUser=async()=>{setLoading(true);try{await client.delete('delete-user/');setUser({logged:false,data:[]});}catch(err){console.error(err);throw new Error('Failed to delete user');}finally{setLoading(false);}};const contextValue={login,logout,user,setUser,signup,resetPassword,deleteUser,loading};return/*#__PURE__*/_jsx(authContext.Provider,{value:contextValue,children:children});}","map":{"version":3,"names":["React","createContext","useContext","useState","axios","jsx","_jsx","authContext","useAuth","context","Error","client","create","baseURL","getAuthToken","localStorage","getItem","interceptors","request","use","config","token","headers","concat","error","Promise","reject","AuthProvider","_ref","children","loading","setLoading","user","setUser","logged","data","login","response","post","console","log","setItem","err","logout","removeItem","signup","res","resetPassword","email","deleteUser","delete","contextValue","Provider","value"],"sources":["C:/Users/Miskinyar/Documents/ProjetY/frontend/src/context/authContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useState } from \"react\";\r\nimport axios from 'axios';\r\n\r\nexport const authContext = createContext();\r\n\r\nexport const useAuth = () => {\r\n    const context = useContext(authContext);\r\n    if (!context) throw new Error('There is no AuthProvider');\r\n    return context;\r\n}\r\n\r\nconst client = axios.create({\r\n    baseURL: 'http://127.0.0.1:8000/api/',\r\n});\r\n\r\nfunction getAuthToken() {\r\n    return localStorage.getItem('token');\r\n}\r\n\r\nclient.interceptors.request.use(\r\n    (config) => {\r\n        const token = getAuthToken();\r\n        if (token) {\r\n            config.headers['Authorization'] = `Token ${token}`;\r\n        }\r\n        return config;\r\n    },\r\n    (error) => Promise.reject(error)\r\n);\r\n\r\nexport function AuthProvider({ children }) {\r\n    const [loading, setLoading] = useState(false);\r\n    const [user, setUser] = useState({\r\n        logged: false,\r\n        data: [],\r\n    });\r\n\r\n    const login = async (data) => {\r\n        setLoading(true);\r\n        try {\r\n            const response = await client.post('login/', data);\r\n            const token = response.data.token;\r\n            console.log('Token:', token);\r\n            localStorage.setItem('token', token);\r\n            setUser({ logged: true, data: response.data });\r\n        } catch (err) {\r\n            console.error('Login error:', err);\r\n            throw new Error('Login failed');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    const logout = async () => {\r\n        if (!user.logged) return console.log(\"User is not logged\");\r\n        setLoading(true);\r\n        try {\r\n            await client.post('logout/');\r\n            localStorage.removeItem('token');\r\n            setUser({ logged: false, data: [] });\r\n        } catch (err) {\r\n            console.error(err);\r\n            throw new Error('Logout failed');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    const signup = async (data) => {\r\n        setLoading(true);\r\n        try {\r\n            const res = await client.post('register/', data);\r\n            return res.data;\r\n        } catch (err) {\r\n            console.error(err);\r\n            throw new Error('Signup failed');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    const resetPassword = async (email) => {\r\n        setLoading(true);\r\n        try {\r\n            const res = await client.post('/reset-password', { email });\r\n            return res.data;\r\n        } catch (err) {\r\n            console.error(err);\r\n            throw new Error('An error occurred while resetting the password');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const deleteUser = async () => {\r\n        setLoading(true);\r\n        try {\r\n            await client.delete('delete-user/');\r\n            setUser({ logged: false, data: [] });\r\n        } catch (err) {\r\n            console.error(err);\r\n            throw new Error('Failed to delete user');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const contextValue = { login, logout, user, setUser, signup, resetPassword, deleteUser, loading };\r\n\r\n    return (\r\n        <authContext.Provider value={contextValue}>\r\n            {children}\r\n        </authContext.Provider>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}